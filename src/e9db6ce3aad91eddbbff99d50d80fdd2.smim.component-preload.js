//@ui5-bundle zhr237/Component-preload.js
jQuery.sap.registerPreloadedModules({
"version":"2.0",
"modules":{
	"zhr237/Component.js":function(){sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","zhr237/model/models"],function(e,t,i){"use strict";return e.extend("zhr237.Component",{metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this.getRouter().initialize();this.setModel(i.createDeviceModel(),"device")}})});
},
	"zhr237/controller/App.controller.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("zhr237.controller.App",{onInit(){}})});
},
	"zhr237/controller/CalendarBookingOverview.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,n,a,o){"use strict";return t.extend("zhr237.controller.CalendarBookingOverview",{_calendarData:{persons:[]},constructor:function(t){this.owner=t;this.libs=new e;this.calendarModel=new n;this.calendarModel.setData(this._calendarData);const a=this.owner.byId("bookingCalendar");a.setModel(this.calendarModel,"calendar")},refresh_calendar:function(){const e=this.owner.byId("bookingCalendar");const t=e.getViewKey()==="Week"?7:31;this.owner.getOwnerComponent().getModel().read("/ZC_HR237_Booking",{filters:[new a("pernr",o.EQ,"77777777"),new a("datum",o.EQ,this.libs.getDateIso(this.libs.get_noon(e.getStartDate()))),new a("layer_id",o.EQ,t)],success:function(e){const t={};for(const n of e.results){const e=t[n.pernr]?t[n.pernr]:{title:n.pernr,text:n.ename,avatar:this.libs.get_avatar_url(n.pernr,64),bookings:[]};const a=this.geWholeDay(n.datum);e.bookings.push({startDate:a.low,endDate:a.high,title:n.layer_id,text:n.place_text,color:"#9CFFF5",_src:n});t[n.pernr]=e}this._calendarData.persons=Object.values(t);this.calendarModel.updateBindings()}.bind(this)})},geWholeDay:function(e){const t=new Date(e.getTime()+e.getTimezoneOffset()*6e4);const n=new Date(t.getTime());n.setDate(n.getDate()+1);return{low:t,high:n}}})});
},
	"zhr237/controller/DeskEdit.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,s,i){"use strict";return t.extend("zhr237.controller.DeskEdit",{owner:null,_desk:{},constructor:function(t){this.owner=t;this.libs=new e;this._model=new sap.ui.model.json.JSONModel;this._model.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this._model.setData(this._desk);this._dialog=sap.ui.xmlfragment("zhr237.fragment.DeskEdit",this);this._dialog.setModel(this._model,"desk");this.owner.getView().addDependent(this._dialog)},showDialog:function(e,t){this.layer_id=e;this._desk.place_text="";this._desk.department="";this.callBack=t;this.deskComboBox=sap.ui.getCore().byId("id_desk_combobox");this.deskComboBox.getBinding("items").filter([new s("layer_id",i.EQ,this.layer_id)]);this._model.updateBindings();this._dialog.open()},onSelectionChange:function(e){const t=e.getParameter("selectedItem");if(t)this._desk.department=t.getBindingContext().getObject().department},handleActionButton:function(e){const t=this.deskComboBox.getSelectedKey();const s=t?t:this.deskComboBox.getValue();const i=`${this.layer_id}-${s}`;if(!i||!i.match(/^[\s\S][\s\S]-\d+-\d+$/)){this.libs.showMessage(`Desk number '${i}' is invalid`,true);return}if(this._desk.department===""){this.libs.showMessage(`Please choose department`,true);return}const o=t==="";if(o&&e==="SAVE")this.libs.showMessage(`Please set position for desk '${i}'`);e=o?"SET":e;this.callBack(e,o,{place_id:i,department:this._desk.department,place_text:s,orgtx:sap.ui.getCore().byId("id_desk_department").getSelectedItem().getBindingContext().getObject().orgtx});this._dialog.close()},handleEditCancelButton:function(){this._dialog.close()}})});
},
	"zhr237/controller/Details.js":function(){sap.ui.define(["zhr237/controller/Libs","zhr237/controller/NewBook","sap/ui/base/Object"],function(t,e,i){"use strict";return i.extend("zhr237.controller.Details",{owner:null,_detail:{},constructor:function(e){this.owner=e;this.libs=new t;this._model=new sap.ui.model.json.JSONModel;this._model.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this._model.setData(this._detail);this._popup=sap.ui.xmlfragment("zhr237.fragment.Details",this);this._popup.setModel(this._model,"detail");this.owner.getView().addDependent(this._popup)},showPopup:function(t){const e=t.getBindingContext("calendar").getObject()._src;this.libs.copy_from(e,this._detail);this._detail._update_is_active=this.libs.getDateIso(this.libs.get_noon(this._detail.datum))>=this.libs.getDateIso(this.libs.get_noon(new Date));this._model.updateBindings();this._popup.openBy(t)},handleEditButton:function(){if(!this.owner._NewBook)this.owner._NewBook=new e(this.owner);this.owner._NewBook.showDialog(this.owner.userInfo,{pernr:this._detail.pernr,datum:this._detail.datum,layer_id:this._detail.layer_id,persa:this._detail.persa,layer_text:this._detail.layer_text,name1:this._detail.name1,place_id:this._detail.place_id,_edit_callback:this.refresh_calendar.bind(this)})},handleEditCancelButton:function(){this._dialog.close()},refresh_calendar:function(){this.owner.onStartDateChange()},handlePopoverDeleteOrCancel:function(){if(!this._detail._update_is_active){this._popup.close();return}const t=this._detail;if(!this.oConfirmDialog){this.oConfirmDialog=new sap.m.Dialog({type:sap.m.DialogType.Message,title:"Confirm",content:new sap.m.Text({text:"Do you want to delete this booking?"}),beginButton:new sap.m.Button({type:sap.m.ButtonType.Emphasized,text:"Delete",press:function(){this.oConfirmDialog.close();this.owner.getView().getModel().remove(`/ZC_HR237_Booking(datum=datetime'${this.libs.getDateIso(t.datum)}T00%3A00%3A00',pernr='${t.pernr}')`,{success:function(){this.libs.showMessage(`Item ${t.place_id} for ${t.ename} at ${this.libs.date_to_text(t.datum)} was successfully deleted`);this.refresh_calendar()}.bind(this)})}.bind(this)}),endButton:new sap.m.Button({text:"Cancel",press:function(){this.oConfirmDialog.close()}.bind(this)})})}this.oConfirmDialog.open()}})});
},
	"zhr237/controller/FileUploadDialog.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/base/Object"],function(e,a){"use strict";return a.extend("zhr237.controller.FileUploadDialog",{owner:null,dialog:null,constructor:function(a){this.owner=a;this.libs=new e;this.dialog=sap.ui.xmlfragment("zhr237.fragment.FileUploadDialog",this);a.getView().addDependent(this.dialog)},show:function(e){this.layer_id=e;this.dialog.open()},handleCancelPress:function(e){this.dialog.close()},handleUploadComplete:function(e){var a=e.getParameters("response");const r=(new DOMParser).parseFromString(a.responseRaw,"text/xml");let t=false;let o="";try{o=r.getElementsByTagName("d:message")[0].childNodes[0].nodeValue;t=r.getElementsByTagName("d:is_error")[0].childNodes[0].nodeValue==="X"}catch(e){o=r.getElementsByTagName("message")[0].childNodes[0].nodeValue;t=true}this.libs.showMessage(o,t)},handleUploadPress:function(){var e=sap.ui.getCore().byId("fupImport");var a="";var r=e.getValue();if(!r){a="Please select a file first";sap.m.MessageToast.show(a);return}this._addTokenToUploader();e.upload();this.dialog.close()},_addTokenToUploader:function(){var e=this.owner.getView().getModel();var a=e.getSecurityToken();var r=sap.ui.getCore().byId("fupImport");var t=new sap.ui.unified.FileUploaderParameter({name:"X-CSRF-Token",value:a});var o=new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:this.layer_id+"|"+encodeURIComponent(r.getValue())});r.removeAllHeaderParameters();r.addHeaderParameter(t);r.addHeaderParameter(o);var s=e.sServiceUrl+"/ZC_HR237_Layer";r.setUploadUrl(s)}})});
},
	"zhr237/controller/FormLayer.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){"use strict";return e.extend("zhr237.controller.FormLayer",{owner:null,_layer:{isNew:false,title:""},constructor:function(e){this.owner=e;this._model=new sap.ui.model.json.JSONModel;this._model.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this._model.setData(this._layer);this._dialog=sap.ui.xmlfragment("zhr237.fragment.FormLayer",this);this._dialog.setModel(this._model,"layer");this.owner.getView().addDependent(this._dialog)},popup:function(e,t,i){const l=t.split("^");this._layer.layer_id=e?"":l[0];this._layer.layer_text=e?"":l[1];this._layer.layer_address=e?"":l[2];this._layer.persa=e?"":l[3];this._layer.isNew=!this._layer.layer_id;this._layer.title=this._layer.isNew?"New layer":"Edit layer";this.callBack=i;this._model.updateBindings();this._dialog.open()},handleActionButton:function(){delete this._layer.isNew;delete this._layer.title;this.callBack(this._layer);this._dialog.close()},handleEditCancelButton:function(){this._dialog.close()}})});
},
	"zhr237/controller/GuardTab.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/base/Object","sap/m/Dialog","sap/m/Button","sap/m/Image","sap/m/HBox"],function(t,e,i,n,a,s){"use strict";return e.extend("zhr237.controller.GuardTab",{owner:null,constructor:function(e){this.owner=e;this.libs=new t;const i=this.libs;e.byId("idCheckBookingTable").attachBeforeRebindTable(function(t){const e=t.getParameter("bindingParams");this.libs.addBindingListener(e,"dataReceived",this.onDataReceived.bind(this))}.bind(this));this.pernrFilter=e.byId("idCheckBookingFilter-filterItemControl_BASIC-pernr");this.basicFilter=e.byId("idCheckBookingFilter-btnBasicSearch");const n=e.byId("idCheckBookingFilter-filterItemControl_BASIC-datum");const a=e.byId("idCheckBookingFilter");n.setValueFormat("yyyy-MM-dd");n.setValueState("None");function s(t){n.setValue(i.getDateIso(i.get_noon(t)))}function r(){a.fireSearch()}s(new Date);r();sap.ui.require(["sap/ndc/BarcodeScannerButton"],function(t){const e=this.owner.byId("idCheckBookingToolbar");e.addContent(new t({dialogTitle:"Barcode Scanner",keepCameraScan:true,scanFail:function(t){this.libs.showMessage("Scan failed: "+t,true)},scanSuccess:function(t){if(t.getParameter("cancelled")){this.libs.showMessage("Scan cancelled",true);return}const e=t.getParameter("text");const i=e.split("-");if(e.length!==17||!this.libs.isNumeric(e.replace("-",""))||i.length!==2||i[0].length!==8||i[1].length!==8){this.libs.showMessage(`QR code ${e} is invalid`,true);return}this.basicFilter.setValue(i[1]);s(new Date(parseInt(i[0].substr(0,4)),parseInt(i[0].substr(4,2))-1,parseInt(i[0].substr(6,2))));r()}.bind(this)}))}.bind(this))},onDataReceived:function(t){const e=t.getParameter("data").results;if(e.length!==1||!this.basicFilter.getValue()&&!this.pernrFilter.getValue())return;const r=e[0];if(!this._avatarDialog)this._avatarDialog=new i({endButton:new n({text:"Cancel",press:function(){this._avatarDialog.close()}.bind(this)}),content:new s({justifyContent:"Center",items:new a})});this._avatarDialog.setTitle(`${r.ename} - ${r.place_text} - ${this.libs.date_to_text(r.datum)}`);this._avatarDialog.getContent()[0].getItems()[0].setSrc(this.libs.get_avatar_url(r.pernr,400));this._avatarDialog.open()}})});
},
	"zhr237/controller/Libs.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){"use strict";return e.extend("zhr237.controller.Libs",{getDateIso:function(e){const t=new Date(e.getTime()-e.getTimezoneOffset()*60*1e3);return t.toISOString().split("T")[0]},date_to_text:function(e){return e.toLocaleString("default",{month:"long",day:"numeric"})},copy_from:function(e,t){for(let e in t)if(t.hasOwnProperty(e))delete t[e];for(let n in e)if(e.hasOwnProperty(n)){t[n]=e[n]}},get_noon:function(e){if(!e)return null;e.setHours(12,0,0,0);return e},get_date_from_now:function(e){const t=this.get_noon(new Date);t.setDate(t.getDate()+e);return t},showMessage:function(e,t){sap.m.MessageToast.show(e,{duration:3500});if(t)$(".sapMMessageToast").css("background","#cc1919")},get_avatar_url:function(e,t){const n=`${document.location.origin}/sap/opu/odata/sap/ZC_PY000_REPORT_CDS/ZC_PY000_PernrPhoto(pernr='${e}')/$value`;if(t)return`${n}?$filter=${encodeURIComponent(`img_size eq ${t}`)}`;return n},get_qr_code_url:function(e,t,n){return`${document.location.origin}/sap/opu/odata/sap/ZC_HR237_BOOKING_CDS/ZC_HR237_QrCode(datum=datetime'${this.getDateIso(e)}T00:00:00',pernr='${t}',action='${n}')/$value`},send_request:function(e){var t=new XMLHttpRequest;t.open("GET",e,true);t.send(null)},isNumeric:function(e){if(typeof e!="string")return false;return!isNaN(e)&&!isNaN(parseFloat(e))},addBindingListener:function(e,t,n){e.events=e.events||{};if(!e.events[t]){e.events[t]=n}else{var o=e.events[t];e.events[t]=function(){n.apply(this,arguments);o.apply(this,arguments)}}}})});
},
	"zhr237/controller/Main.controller.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/core/mvc/Controller","zhr237/controller/SchemaLayer","zhr237/controller/FormLayer","zhr237/controller/NewBook","zhr237/controller/CalendarBookingOverview","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,s,r,n,o,a){"use strict";return t.extend("zhr237.controller.Main",{onInit:function(){this._setMessageParser();this.libs=new e;this.mainView=this.byId("main_view");this.mainView.bindElement({path:"/ZC_HR237_CUR_USER('')",events:{dataReceived:function(){this.userInfo=this.mainView.getBindingContext().getObject();this.byId("avatar_big").setSrc(this.libs.get_avatar_url(this.userInfo.pernr));this.byId("avatar_small").setSrc(this.libs.get_avatar_url(this.userInfo.pernr),64)}.bind(this)}});this.calendarBookingOverview=new n(this)},onSectionChange:function(e){switch(e.getParameter("section")){case this.byId("bookingTab"):this.onStartDateChange();return;case this.byId("guardTab"):this._init_guard_tab();return}},onStartDateChange:function(){this.calendarBookingOverview.refresh_calendar()},_init_guard_tab:function(){sap.ui.require(["zhr237/controller/GuardTab"],function(e){if(!this._GuardTab)this._GuardTab=new e(this)}.bind(this))},uploadImage:function(e){const t=e.getSource().getProperty("target");sap.ui.require(["zhr237/controller/FileUploadDialog"],function(e){if(!this._fileUploadDialog)this._fileUploadDialog=new e(this);this._fileUploadDialog.show(t)}.bind(this))},_setMessageParser:function(){const e=this.getOwnerComponent().getModel();sap.ui.require(["zhr237/controller/MessageParser"],function(t){const i=new t(e.sServiceUrl,e.oMetadata,!!e.bPersistTechnicalMessages);e.setMessageParser(i)})},onEditDeskPosition:function(e){if(!this._schemaLayer)this._schemaLayer=new i(this);this._schemaLayer.display(e.getSource().getProperty("target"))},handleFormClick:function(e,t,i){const r=i==="NEW";let n;switch(t){case"Layer":n=new s(this);break}const o=`${t.toLowerCase()}_id`;n.popup(r,r?"":e.getSource().getTarget(),function(e){const i=r?"create":"update";const s=`/ZC_HR237_${t}${r?"":`('${e[o]}')`}`;this.getView().getModel()[i](s,e,{success:function(){this.libs.showMessage.show(`${t} ${e[o]} was successfully ${i}ed`)}.bind(this)})}.bind(this))},onBookClick:function(){if(!this._NewBook)this._NewBook=new r(this);const e=this.libs.get_noon(new Date);e.setDate(e.getDate()+1);this._NewBook.showDialog(this.userInfo,{pernr:this.userInfo.pernr,datum:e,layer_id:"-",persa:"-",layer_text:"Select Schema",name1:"",layer_address:"",place_id:""})},handleAppointmentSelect:function(e){const t=e.getParameter("appointment");if(!t)return;sap.ui.require(["zhr237/controller/Details"],function(e){if(!this.details)this.details=new e(this);this.details.showPopup(t)}.bind(this))},handleSupportEmail:function(){sap.m.URLHelper.triggerEmail(this.userInfo.support_email,this.userInfo.support_subject,this.userInfo.support_body)},showQrCode:function(){window.open(this.libs.get_qr_code_url(this.userInfo.nearest_book_date,this.userInfo.pernr,"SHOW_QR"))}})});
},
	"zhr237/controller/MessageParser.js":function(){sap.ui.define(["zhr237/controller/Libs","sap/ui/model/odata/ODataMessageParser"],function(e,s){"use strict";return s.extend("zhr237.ext.controller.MessageParser",{libs:new e,parse:function(e,r,t,n,o){var a=this;s.prototype.parse.apply(a,arguments);if(e.statusCode<400||e.statusCode>=600)return;const i={request:r,response:e,url:r.requestUri};const u=this._parseBody(e,i);const c=[];const p=[];for(let e of u){if(e.message.indexOf("An exception was raised")===-1&&e.message.indexOf("In the context of Data Services an unknown internal server error occurred")===-1)c.push(e.message);p.push(e.type)}if(c.length===0)return;this.libs.showMessage(c.join("\n"),p.indexOf("Error")>=0)}})});
},
	"zhr237/controller/NewBook.js":function(){sap.ui.define(["zhr237/controller/Libs","zhr237/controller/SchemaLayer","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,s,i,o){"use strict";return s.extend("zhr237.controller.NewBook",{owner:null,_book:{},constructor:function(t){this.owner=t;this.libs=new e;this._model=new sap.ui.model.json.JSONModel;this._model.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this._model.setData(this._book);this._dialog=sap.ui.xmlfragment("zhr237.fragment.NewBook",this);this._dialog.setModel(this._model,"book");this.owner.getView().addDependent(this._dialog)},showDialog:function(e,t){this.userInfo=e;this.previous_values=t;this.libs.copy_from(t,this._book);this._book.minDate=this.libs.get_date_from_now(e.min_date);this._book.maxDate=this.libs.get_date_from_now(e.max_date);this._book.is_manager=e.is_manager;this.layerCombobox=sap.ui.getCore().byId("id_new_layer_id");this.pernrCombobox=sap.ui.getCore().byId("id_new_book_pernr");this.desksCombobox=sap.ui.getCore().byId("id_new_book_desk");this.layerCombobox.getBinding("items").filter(new i("persa",o.EQ,this.userInfo.persa));this._update_bindings();this._model.updateBindings();this._dialog.open()},_update_bindings:function(){this.pernrCombobox.getBinding("items").filter([new i("persa",o.EQ,this._book.persa)]);this.owner.getOwnerComponent().getModel().read("/ZC_HR237_Booking",{filters:this._make_default_filter(new i("datum",o.EQ,this.libs.getDateIso(this.libs.get_noon(this._book.datum)))),urlParameters:{$select:"place_id"+",pernr,ename,user_name,created_when"},success:function(e){if(this.previous_values._edit_callback)e.results=e.results.filter(e=>e.place_id!==this.previous_values.place_id);this._skip_desks=e.results;const t=this._make_default_filter();for(let e of this._skip_desks)t.push(new i("place_id",o.NE,e.place_id));this.desksCombobox.getBinding("items").filter(t)}.bind(this)})},_make_default_filter:function(e){const t=e?[e]:[];if(this._book.layer_address)t.push(new i("layer_id",o.EQ,this._book.layer_id));const s=this.pernrCombobox.getSelectedItem();const a=s?s.getBindingContext().getObject().department:this.userInfo.department;t.push(new i("department",o.EQ,a));return t},_on_schema_combobox_changed:function(e){if(!e.getSource().getSelectedKey())return;const t=e.getParameter("selectedItem").getBindingContext().getObject();this._book.layer_id=t.layer_id;this._book.layer_text=t.layer_text;this._book.layer_address=t.layer_address;this._book.persa=t.persa;this._book.name1=t.name1;this._update_bindings()},onDateChanged:function(e){if(e&&!e.getParameter("valid"))return;this._update_bindings()},handleActionButton:function(){const e={datum:this.libs.get_noon(this._book.datum),pernr:this.pernrCombobox.getSelectedKey(),place_id:this.desksCombobox.getSelectedKey()};console.log(e);console.log(this.desksCombobox.getValue());console.log(this.desksCombobox.getSelectedItem());if(!e.pernr||!e.place_id||!this._book.datum){this.libs.showMessage("Fill all required fields",true);return}if(this.previous_values._edit_callback){e.datum_prev=this.previous_values.datum;e.pernr_prev=this.previous_values.pernr;e.place_id_prev=this.previous_values.place_id}this.owner.getView().getModel().create(this._book._edit_callback?"/ZC_HR237_QrCode":"/ZC_HR237_Booking",e,{success:function(e){this.libs.send_request(this.libs.get_qr_code_url(e.datum,e.pernr,"NOTIFY"));this.libs.showMessage(`Desk ${e.place_text} booked for ${this.libs.date_to_text(e.datum)}\n`+`Notification to ${e.ename} via email is sent`);if(this.previous_values._edit_callback)this.previous_values._edit_callback();this.owner.mainView.getObjectBinding().refresh();this._dialog.close()}.bind(this)})},onShowMap:function(){if(!this._book.layer_address){this.libs.showMessage("Please select schema",true);return}window.open(`https://www.google.com/maps/place/${encodeURIComponent(this._book.layer_address)}`,"_blank").focus()},onWhatchSchema:function(){if(!this._book.layer_address){this.libs.showMessage("Please select schema",true);return}if(!this.owner._schemaLayer)this.owner._schemaLayer=new t(this.owner);const e=this._make_default_filter();this.owner._schemaLayer.display(`${this._book.layer_id}^${this._book.layer_text}`,{addFilter:e,skip_desks:this._skip_desks,callBack:function(e){this.desksCombobox.setSelectedKey(e)}.bind(this)})},handleEditCancelButton:function(){this._dialog.close()}})});
},
	"zhr237/controller/SchemaLayer.js":function(){sap.ui.define(["zhr237/controller/Libs","zhr237/controller/DeskEdit","sap/ui/base/Object","sap/suite/ui/commons/networkgraph/layout/NoopLayout","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,s,o,n){"use strict";return i.extend("zhr237.controller.SchemaLayer",{owner:null,_item:{is_localhost:window.location.hostname==="localhost",title:"",editMode:false,nodes:[],rooms:[]},constructor:function(t){this.owner=t;this.libs=new e;this._model=new sap.ui.model.json.JSONModel;this._model.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this._model.setData(this._item)},display:function(e,t){this.ext=t?t:{};const i=e.split("^");const o=i[0];const n=i[1];this.layer_id=o;this._item.editMode=!this.ext.addFilter;this._item.chooseText="Choose desk";this._item.chooseEnabled=false;this._item.title=`${this._item.editMode?"Edit desks":"Choose desk"} of ${n} (${o})`;if(!this._dialog){this._dialog=sap.ui.xmlfragment("zhr237.fragment.SchemaLayer",this);this._dialog.setModel(this._model,"item");this.owner.getView().addDependent(this._dialog);this._graph=sap.ui.getCore().byId("graph");this._graph.setLayoutAlgorithm(new s)}this.fillAndShow(o)},fillAndShow:function(e){for(let e of this._graph.getNodes().filter(e=>e.getSelected()))e.setSelected(false);this._item.nodes=[];this._item.rooms=[];let t=[new o("layer_id",n.EQ,e),new o("place_x",n.NE,0),new o("place_y",n.NE,0)];if(this.ext&&this.ext.addFilter)t=[...t,...this.ext.addFilter];this.owner.getOwnerComponent().getModel().read("/ZC_HR237_Place",{filters:t,urlParameters:{$select:`place_id,place_text,place_x,place_y,orgtx`},success:function(t){if(this.ext&&this.ext.skip_desks)for(let e of this.ext.skip_desks){let i=t.results.find(t=>t.place_id===e.place_id);if(i){i.pernr=e.pernr;i.ename=e.ename;i.user_name=e.user_name;i.created_when=e.created_when;i.orgtx=`${i.orgtx} - booked`}}for(let e of t.results)this._add1Desk(e);if(t.results.length===0)this._add1Desk({place_id:999,place_text:"Dummy just ignore me :)",place_x:1,place_y:1});this._model.updateBindings();const i=`${window.location.origin}/sap/opu/odata/sap/ZC_HR237_BOOKING_CDS/ZC_HR237_Layer('${e}')/`+encodeURIComponent("$value");this.toDataURL(i,function(e){this._graph.setBackgroundImage(e)}.bind(this));this._dialog.open()}.bind(this)})},toDataURL:function(e,t){var i=new XMLHttpRequest;i.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)};e.readAsDataURL(i.response)};i.open("GET",e);i.responseType="blob";i.send()},_add1Desk:function(e,t){for(let i=0;i===0;i++){if(!t)break;const i=this._item.nodes.filter(t=>t.key===e.place_id)[0];if(!i)break;if(e.place_x&&e.place_y){i.x=e.place_x;i.y=e.place_y}i.title=`${e.place_text} - ${e.orgtx}`;return}this._item.nodes.push({key:e.place_id,title:`${e.place_text} - ${e.orgtx}`,x:e.place_x,y:e.place_y,status:e.ename?"Error":"Success",attributes:e.ename?[{label:e.pernr,value:e.ename},{label:e.created_when.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:false}),value:e.user_name}]:null})},_onAfterDialogOpen:function(){const e=sap.ui.getCore().byId("graph-toolbar");for(let t of e.getContent())try{switch(t.getTooltip()){case"Zoom to Fit":t.firePress();break;case"Enter Full Screen":t.setVisible(false);break}}catch(e){console.error(e)}document.getElementById("graph-innerscroller").addEventListener("click",this._onClick.bind(this))},handleEditDesk:function(){if(!this._DeskEdit)this._DeskEdit=new t(this.owner);this.current_desk=null;this._DeskEdit.showDialog(this.layer_id,function(e,t,i){this.current_desk_new=t;this.current_desk=i;if(e==="SAVE")this._doSave()}.bind(this))},_doSave:function(){const e=this.current_desk_new?"create":"update";const t="/ZC_HR237_Place"+(this.current_desk_new?"":`('${this.current_desk.place_id}')`);const i=this.current_desk;this.current_desk=null;const s={...i};delete s.place_text;delete s.orgtx;const o=this;this.owner.getView().getModel()[e](t,s,{success:function(t){t=t?t:i;o.libs.showMessage(`Desk ${t.place_id} was successfully ${e}ed`);o._add1Desk(t,true);o._model.updateBindings()}})},_onClick:function(e){if(!this.current_desk)return;const t=e.target.getBoundingClientRect();const i=this._graph.getCurrentZoomLevel();this.current_desk.place_x=Math.round((e.clientX-t.left)/i)-50;this.current_desk.place_y=Math.round((e.clientY-t.top)/i);this._doSave()},handleEditCancelButton:function(){this._dialog.close()},onSelectionChange:function(){const e=this._graph.getNodes().filter(e=>e.getSelected());const t=e.length===1&&e[0].getStatus()==="Success"?e[0]:null;this._item.chooseText=t?`Choose desk '${t.getKey().substr(3)}'`:"Choose desk";this._item.chooseEnabled=!!t;this.ext.selected_place_id=t?t.getKey():null;this._model.updateBindings()},handleDeskChoosed:function(){if(!this.ext.selected_place_id)return;this.ext.callBack(this.ext.selected_place_id);this._dialog.close()},_doAlign:function(){const e=this._graph.getNodes().filter(e=>e.getSelected()).map(e=>({place_id:e.getKey(),place_x:e.getX(),place_y:e.getY()}));if(e.length<2){this.libs.showMessage("Select more items",true);return}const t=this.getStandardDeviation(e,"place_x");const i=this.getStandardDeviation(e,"place_y");const s=t.deviation<4?t:i.deviation<4?i:false;if(!s){this.libs.showMessage("Deviation is too big",true)}for(let t of e){t[s.field]=s.mean;this.owner.getView().getModel().update(`/ZC_HR237_Place('${t.place_id}')`,t)}this.libs.showMessage(`${e.length} items aligned`);this._graph.deselect()},getStandardDeviation:function(e,t){const i=e.length;const s=e.reduce((e,i)=>e+i[t],0)/i;return{deviation:Math.sqrt(e.map(e=>Math.pow(e[t]-s,2)).reduce((e,t)=>e+t)/i),mean:Math.round(s),field:t}}})});
},
	"zhr237/fragment/DeskEdit.fragment.xml":'<core:FragmentDefinition\r\n\t\txmlns="sap.m"\r\n\t\txmlns:l="sap.ui.layout"\r\n\t\txmlns:f="sap.ui.layout.form"\r\n\t\txmlns:core="sap.ui.core"><Dialog title="Create or Edit desk" afterOpen="_onAfterDialogOpen"><buttons><Button text="Save" type="Emphasized" press=".handleActionButton(\'SAVE\')"/><Button text="Set position in map" press="handleActionButton(\'SET\')"/><Button text="Cancel" press="handleEditCancelButton"/></buttons><l:VerticalLayout\r\n\t\t\t\tclass="sapUiContentPadding"\r\n\t\t\t\twidth="100%"><f:SimpleForm\r\n\t\t\t\t\teditable="true"\r\n\t\t\t\t\tlayout="ResponsiveGridLayout"\r\n\t\t\t\t\tsingleContainerFullSize="false"><Label text="Desk"/><ComboBox\r\n\t\t\t\t    id="id_desk_combobox"\r\n                    value="{desk>/place_text}"\r\n\t\t\t\t\trequired="true"\r\n                    items="{/ZC_HR237_Place}"\r\n\t\t\t\t\tselectionChange="onSelectionChange"><core:Item key="{place_text}" text="{place_text} - {orgtx}" /></ComboBox><Label text="Department"/><ComboBox\r\n\t\t\t\t    id="id_desk_department"\r\n                    selectedKey="{desk>/department}"\r\n\t\t\t\t\trequired="true"\r\n                    items="{/ZC_HR237_Department}"><core:Item key="{orgeh}" text="{orgeh} - {orgtx}" /></ComboBox></f:SimpleForm></l:VerticalLayout></Dialog></core:FragmentDefinition>',
	"zhr237/fragment/Details.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:f="sap.ui.layout.form" xmlns:core="sap.ui.core"><ResponsivePopover title="{detail>/layer_text} ({detail>/layer_id})" class="sapUiResponsivePadding--header" placement="Auto"><beginButton><Button text="Edit" type="Emphasized" press="handleEditButton" visible="{detail>/_update_is_active}"/></beginButton><endButton><Button text="{= ${detail>/_update_is_active}?\'Delete\':\'Cancel\'}" press="handlePopoverDeleteOrCancel"/></endButton><f:SimpleForm editable="false" layout="ResponsiveGridLayout" singleContainerFullSize="false"><Label text="Booking date"/><Text text="{ path: \'detail>/datum\', type: \'sap.ui.model.type.Date\', formatOptions: { pattern: \'dd.MM.yyyy\', UTC: true } }" /><Label text="Personnel Number"/><Text text="{path : \'detail>/pernr\', type : \'sap.ui.model.odata.type.String\', constraints : {isDigitSequence : true, maxLength : 8 }}" /><Label text="Employee Name" labelFor="moreInfo" /><Text text="{detail>/ename}" /><Label text="Desk" /><Text text="{detail>/place_text}" /><Label text="Created by" /><Text text="{detail>/user_name} at { path: \'detail>/created_when\', type: \'sap.ui.model.type.Time\', formatOptions: { pattern: \'dd.MM.yyyy HH:mm:ss\', UTC: true } }" /></f:SimpleForm></ResponsivePopover></core:FragmentDefinition>\n',
	"zhr237/fragment/FileUploadDialog.fragment.xml":'<core:FragmentDefinition\r\n            xmlns="sap.m"\r\n            xmlns:form="sap.ui.layout.form"\r\n            xmlns:core="sap.ui.core"            \r\n            xmlns:u="sap.ui.unified"><Dialog class="sapUiPopupWithPadding" title="Import from Excel" resizable="false" draggable="false" showHeader="false" horizontalScrolling="false"><content><form:SimpleForm title="Upload"><form:content><u:FileUploader id="fupImport" name="myFileUpload" tooltip="Upload (*.*)" uploadComplete="handleUploadComplete" style="Emphasized" placeholder="Choose a file for Upload (*.*)" sendXHR="true" useMultipart="false" /></form:content></form:SimpleForm></content><buttons><Button text="Upload File" type="Emphasized" id="btnUpload" press="handleUploadPress" /><Button text="Cancel" type="Emphasized" id="btnCancel" press="handleCancelPress" /></buttons></Dialog></core:FragmentDefinition>\r\n',
	"zhr237/fragment/FormLayer.fragment.xml":'<core:FragmentDefinition\r\n\t\txmlns="sap.m"\r\n\t\txmlns:l="sap.ui.layout"\r\n\t\txmlns:f="sap.ui.layout.form"\r\n\t\txmlns:core="sap.ui.core"><Dialog title="{layer>/title}" afterOpen="_onAfterDialogOpen"><beginButton><Button text="Ok" type="Emphasized" press="handleActionButton"/></beginButton><endButton><Button text="Cancel" press="handleEditCancelButton"/></endButton><l:VerticalLayout\r\n\t\t\t\tclass="sapUiContentPadding"\r\n\t\t\t\twidth="100%"><f:SimpleForm\r\n\t\t\t\t\teditable="true"\r\n\t\t\t\t\tlayout="ResponsiveGridLayout"\r\n\t\t\t\t\tsingleContainerFullSize="false"><Label text="Layer"/><Input value="{layer>/layer_id}"\r\n\t\t\t\t\t   editable="{layer>/isNew}"\r\n\t\t\t\t\t   required="true"/><Label text="Layer text"/><Input value="{layer>/layer_text}"\r\n                       maxLength="100"\r\n\t\t\t\t\t   required="true"/><Label text="Layer address"/><Input value="{layer>/layer_address}"\r\n                       maxLength="255"\r\n\t\t\t\t\t   required="true"/><Label text="Personnel area"/><ComboBox\r\n                    selectedKey="{layer>/persa}"\r\n\t\t\t\t\trequired="true"\r\n                    items="{\r\n                        path: \'/ZC_PY000_PersonnelArea\',\r\n                        sorter: { path: \'persa\' }\r\n                    }"><core:Item key="{persa}" text="{persa} - {name1}" /></ComboBox></f:SimpleForm></l:VerticalLayout></Dialog></core:FragmentDefinition>',
	"zhr237/fragment/NewBook.fragment.xml":'<core:FragmentDefinition\r\n\t\txmlns="sap.m"\r\n\t\txmlns:l="sap.ui.layout"\r\n\t\txmlns:f="sap.ui.layout.form"\r\n\t\txmlns:core="sap.ui.core"><Dialog title="{book>/layer_text} ({book>/layer_id}) - {book>/name1} ({book>/persa})" afterOpen="_onAfterDialogOpen"><buttons><Button text="{= ${book>/_edit_callback} ? \'Change\': \'Book\'}" type="Emphasized" press="handleActionButton"/><Button text="Cancel" press="handleEditCancelButton"/></buttons><l:VerticalLayout\r\n\t\t\t\tclass="sapUiContentPadding"\r\n\t\t\t\twidth="100%"><f:SimpleForm\r\n\t\t\t\t\teditable="true"\r\n\t\t\t\t\tlayout="ResponsiveGridLayout"\r\n\t\t\t\t\tsingleContainerFullSize="false"><Label text="Date"/><DatePicker required="true"\r\n                            value="{ path: \'book>/datum\', type: \'sap.ui.model.type.Date\', formatOptions: { pattern: \'dd.MM.yyyy\', UTC: true } }"\r\n                            minDate="{book>/minDate}"\r\n\t\t\t\t\t\t\tmaxDate="{book>/maxDate}"\r\n                            change="onDateChanged"/><Label text="Schema"/><ComboBox\r\n\t\t\t\t    id="id_new_layer_id"\r\n                    selectedKey="{book>/layer_id}"\r\n\t\t\t\t\trequired="true"\r\n                    items="{/ZC_HR237_Layer}"\r\n\t\t\t\t\tselectionChange="_on_schema_combobox_changed"\r\n                    ><core:Item key="{layer_id}" text="{layer_id} - {layer_text}" /></ComboBox><Label text="Employee" visible="{book>/is_manager}"/><ComboBox                \r\n                    id="id_new_book_pernr"\r\n                    selectedKey="{book>/pernr}"\r\n\t\t\t\t\trequired="true"\r\n                    items="{/ZC_HR237_DIR_SUBO}"\r\n                    visible="{book>/is_manager}"><core:Item key="{pernr}" text="{pernr} - {full_name}" /></ComboBox><Label text="Desk"/><HBox width="100%"><ComboBox\r\n\t\t\t\t    id="id_new_book_desk"\r\n                    selectedKey="{book>/place_id}"\t\t\t\t\t\r\n\t\t\t\t\trequired="true"\r\n                    items="{/ZC_HR237_Place}"\r\n                    ><core:Item key="{place_id}" text="{place_text} - {orgtx}" /></ComboBox><Button text="Show desks" icon="sap-icon://map-2" press="onWhatchSchema" /><Button icon="sap-icon://map" press="onShowMap" tooltip="Show map"/></HBox></f:SimpleForm></l:VerticalLayout></Dialog></core:FragmentDefinition>',
	"zhr237/fragment/SchemaLayer.fragment.xml":'<core:FragmentDefinition\r\n        xmlns="sap.suite.ui.commons.networkgraph"\r\n        xmlns:m="sap.m"\r\n        xmlns:l="sap.ui.layout"\r\n        xmlns:core="sap.ui.core"\t\t\r\n        ><m:Dialog title="{item>/title}"\r\n              afterOpen="_onAfterDialogOpen" resizable="true"><m:buttons><m:Button text="Edit desk" press="handleEditDesk" visible="{item>/editMode}"/><m:Button press="handleDeskChoosed" visible="{= !${item>/editMode}}"\r\n                     text="{item>/chooseText}"\r\n                     enabled="{item>/chooseEnabled}"/><m:Button text="Cancel" press="handleEditCancelButton"/><m:Button text="Align" press="_doAlign" visible="{= ${item>/is_localhost} &amp;&amp; ${item>/editMode}}"/></m:buttons><Graph  id="graph"\r\n                    enableWheelZoom="true"\r\n                    enableZoom="true"\r\n                    width="75rem"\r\n                    height="53rem"\r\n                    nodes="{item>/nodes}"\r\n                    selectionChange="onSelectionChange"                  \r\n                    ><nodes><Node\r\n                            key="{item>key}"\r\n                            title="{item>title}"\r\n                            icon="{icon}"                            \r\n                            showActionLinksButton="false"\r\n                            status="{item>status}"\r\n                            x="{item>x}"\r\n                            y="{item>y}" \r\n                            attributes="{path:\'item>attributes\', templateShareable:true}"                           \r\n                            shape="Circle"><attributes><ElementAttribute\r\n                                    label="{item>label}"\r\n                                    value="{item>value}"/></attributes></Node></nodes></Graph></m:Dialog></core:FragmentDefinition>',
	"zhr237/i18n/i18n.properties":'# This is the resource bundle for zhr237\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Hybrid booking system\n\n#YDES: Application description\nappDescription=\r\n#XTIT: Main view title\ntitle=Hybrid booking system',
	"zhr237/i18n/i18n_en.properties":'# This is the resource bundle for zhr237\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Hybrid booking system\n\n#YDES: Application description\nappDescription=\n#XTIT: Main view title\ntitle=Hybrid booking system',
	"zhr237/i18n/i18n_en_GB.properties":'# This is the resource bundle for zhr237\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Hybrid booking system\n\n#YDES: Application description\nappDescription=\n#XTIT: Main view title\ntitle=Hybrid booking system',
	"zhr237/manifest.json":'{"_version":"1.42.0","sap.app":{"id":"zhr237","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.8.1","toolsId":"ca7f9bcd-203a-4ad7-ad0e-8b52053a9848"},"dataSources":{"mainService":{"uri":"/sap/opu/odata/sap/ZC_HR237_BOOKING_CDS/","type":"OData","settings":{"annotations":[],"localUri":"localService/metadata.xml","odataVersion":"2.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.102.0","libs":{"sap.m":{},"sap.ui.core":{},"sap.f":{},"sap.suite.ui.generic.template":{},"sap.ui.comp":{},"sap.ui.generic.app":{},"sap.ui.table":{},"sap.ushell":{},"sap.suite.ui.commons":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"zhr237.i18n.i18n"}},"":{"dataSource":"mainService","preload":true,"settings":{"defaultCountMode":"Inline","metadataUrlParams":{"sap-value-list":"all"}}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","async":true,"viewPath":"zhr237.view","controlAggregation":"pages","controlId":"app","clearControlAggregation":false},"routes":[{"name":"RouteMain","pattern":":?query:","target":["TargetMain"]}],"targets":{"TargetMain":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"Main","viewName":"Main"}}},"rootView":{"viewName":"zhr237.view.App","type":"XML","async":true,"id":"App"}}}',
	"zhr237/model/models.js":function(){sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
},
	"zhr237/utils/locate-reuse-libs.js":'(function(e){var t=function(e,t){var n=["sap.apf","sap.base","sap.chart","sap.collaboration","sap.f","sap.fe","sap.fileviewer","sap.gantt","sap.landvisz","sap.m","sap.ndc","sap.ovp","sap.rules","sap.suite","sap.tnt","sap.ui","sap.uiext","sap.ushell","sap.uxap","sap.viz","sap.webanalytics","sap.zen"];Object.keys(e).forEach(function(e){if(!n.some(function(t){return e===t||e.startsWith(t+".")})){if(t.length>0){t=t+","+e}else{t=e}}});return t};var n=function(e){var n="";if(e){if(e["sap.ui5"]&&e["sap.ui5"].dependencies){if(e["sap.ui5"].dependencies.libs){n=t(e["sap.ui5"].dependencies.libs,n)}if(e["sap.ui5"].dependencies.components){n=t(e["sap.ui5"].dependencies.components,n)}}if(e["sap.ui5"]&&e["sap.ui5"].componentUsages){n=t(e["sap.ui5"].componentUsages,n)}}return n};var r=function(e){var t=e;return new Promise(function(r,a){$.ajax(t).done(function(e){r(n(e))}).fail(function(){a(new Error("Could not fetch manifest at \'"+e))})})};var a=function(e){if(e){Object.keys(e).forEach(function(t){var n=e[t];if(n&&n.dependencies){n.dependencies.forEach(function(e){if(e.url&&e.url.length>0&&e.type==="UI5LIB"){jQuery.sap.log.info("Registering Library "+e.componentId+" from server "+e.url);jQuery.sap.registerModulePath(e.componentId,e.url)}})}})}};e.registerComponentDependencyPaths=function(e){return r(e).then(function(e){if(e&&e.length>0){var t="/sap/bc/ui2/app_index/ui5_app_info?id="+e;var n=jQuery.sap.getUriParameters().get("sap-client");if(n&&n.length===3){t=t+"&sap-client="+n}return $.ajax(t).done(a)}})}})(sap);var scripts=document.getElementsByTagName("script");var currentScript=document.getElementById("locate-reuse-libs");if(!currentScript){currentScript=document.currentScript}var manifestUri=currentScript.getAttribute("data-sap-ui-manifest-uri");var componentName=currentScript.getAttribute("data-sap-ui-componentName");var useMockserver=currentScript.getAttribute("data-sap-ui-use-mockserver");var bundleResources=function(){jQuery.sap.require("jquery.sap.resources");var e=sap.ui.getCore().getConfiguration().getLanguage();var t=jQuery.sap.resources({url:"i18n/i18n.properties",locale:e});document.title=t.getText("appTitle")};sap.registerComponentDependencyPaths(manifestUri).catch(function(e){jQuery.sap.log.error(e)}).finally(function(){sap.ui.getCore().attachInit(bundleResources);if(componentName&&componentName.length>0){if(useMockserver&&useMockserver==="true"){sap.ui.getCore().attachInit(function(){sap.ui.require([componentName.replace(/\\./g,"/")+"/localService/mockserver"],function(e){e.init();sap.ushell.Container.createRenderer().placeAt("content")})})}else{sap.ui.require(["sap/ui/core/ComponentSupport"]);sap.ui.getCore().attachInit(bundleResources)}}else{sap.ui.getCore().attachInit(function(){sap.ushell.Container.createRenderer().placeAt("content")})}});sap.registerComponentDependencyPaths(manifestUri);',
	"zhr237/view/App.view.xml":'<mvc:View controllerName="zhr237.controller.App"\n    xmlns:html="http://www.w3.org/1999/xhtml"\n    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"\n    xmlns="sap.m"><App id="app"></App></mvc:View>\n',
	"zhr237/view/Main.view.xml":'<mvc:View controllerName="zhr237.controller.Main"\n          displayBlock="true"\n          xmlns="sap.uxap"\n          xmlns:m="sap.m"\n          xmlns:mvc="sap.ui.core.mvc"\n          xmlns:l="sap.ui.layout"\n          xmlns:unified="sap.ui.unified"\n          xmlns:core="sap.ui.core"\n          xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"\n          xmlns:smartTable="sap.ui.comp.smarttable"><ObjectPageLayout id="main_view"\n\t                  enableLazyLoading="true"\n\t                  upperCaseAnchorBar="false"\n\t                  useIconTabBar="true"\n\t\t\t\t\t  sectionChange="onSectionChange"><headerTitle><ObjectPageDynamicHeaderTitle><breadcrumbs><m:Breadcrumbs currentLocationText="For emergency case only"><m:Link text="Write to support team" press="handleSupportEmail"/></m:Breadcrumbs></breadcrumbs><expandedHeading><m:HBox><m:Title text="{full_name}" wrapping="true"/><m:ObjectMarker type="Favorite" class="sapUiTinyMarginBegin" visible="{is_worker}"/></m:HBox></expandedHeading><snappedHeading><m:FlexBox fitContainer="true" alignItems="Center"><m:Avatar id="avatar_small" class="sapUiTinyMarginEnd"/><m:Title text="{full_name}" wrapping="true"/></m:FlexBox></snappedHeading><expandedContent><m:VBox><m:Text text="{i18n>title}. Assigned roles: {roles_info}"/><m:Text text="Personnel Number: {pernr} {department_txt} ({department}) - {persa_txt} ({persa})"/></m:VBox></expandedContent></ObjectPageDynamicHeaderTitle></headerTitle><headerContent><m:FlexBox wrap="Wrap"><m:Avatar id="avatar_big" class="sapUiTinyMarginEnd" displaySize="L"/><l:VerticalLayout class="sapUiSmallMarginBeginEnd" visible="{= ${nearest_book_info_label}.length > 0}"><m:Text text="Nearest booknig made by {nearest_book_info_label}"/><m:Link text="QR code {nearest_book_info_text}"\n\t\t\t\t\t        press="showQrCode" /></l:VerticalLayout><l:VerticalLayout class="sapUiSmallMarginBeginEnd" visible="{= ${nearest_book_info_label}.length === 0}"><m:MessageStrip text="There is no nearest booking" type="Warning"/></l:VerticalLayout></m:FlexBox></headerContent><sections><ObjectPageSection titleUppercase="false" visible="{= ${is_worker} || ${is_manager} }"\n\t\t\t                   id="bookingTab"><customAnchorBarButton><m:Button icon="sap-icon://check-availability"\n\t\t\t\t\t          text="Bookings overview"/></customAnchorBarButton><ObjectPageSubSection><m:PlanningCalendar\n\t\t\t\t\t\t\tid="bookingCalendar" \t\t\t\t\n\t\t\t\t\t\t\trows="{calendar>/persons}"\n\t\t\t\t\t\t\tviewKey="Week"\n\t\t\t\t\t\t\tfirstDayOfWeek="1"\n\t\t\t\t\t\t\tstartDateChange="onStartDateChange"\n\t\t\t\t\t\t\tappointmentsVisualization="Filled"\n\t\t\t\t\t\t\tshowEmptyIntervalHeaders="true"\n\t\t\t\t\t\t\tappointmentSelect="handleAppointmentSelect"><m:toolbarContent><m:Button text="Create" press=".onBookClick($event, true)" tooltip="Create new booking" /></m:toolbarContent><m:views><m:PlanningCalendarView key="Week" intervalType="Week" description="Week" intervalsS="1" intervalsM="2" intervalsL="7"/><m:PlanningCalendarView key="OneMonth" intervalType="OneMonth" description="Month" intervalsL="31"  /></m:views><m:rows><m:PlanningCalendarRow\n\t\t\t\t\t\t\t\t                    icon="{calendar>avatar}"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle="{calendar>title}"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext="{calendar>text}"\n\t\t\t\t\t\t\t\t\t\t\t\t\tappointments="{path : \'calendar>bookings\', templateShareable: true}"\n\t\t\t\t\t\t\t\t\t\t\t\t\t><m:appointments><unified:CalendarAppointment\n\t\t\t\t\t\t\t\t\t\t\tstartDate="{calendar>startDate}"\n\t\t\t\t\t\t\t\t\t\t\tendDate="{calendar>endDate}"                            \n\t\t\t\t\t\t\t\t\t\t\ttitle="{calendar>title}"\n\t\t\t\t\t\t\t\t\t\t\ttext="{calendar>text}"\n\t\t\t\t\t\t\t\t\t\t\ttooltip="{calendar>text}"\n\t\t\t\t\t\t\t\t\t\t\ttype="{calendar>type}"\n\t\t\t\t\t\t\t\t\t\t\tcolor="{calendar>color}"\n\t\t\t\t\t\t\t\t\t\t/></m:appointments></m:PlanningCalendarRow></m:rows></m:PlanningCalendar></ObjectPageSubSection></ObjectPageSection><ObjectPageSection id="guardTab"\n\t\t\t                   titleUppercase="false" visible="{is_guard}"><customAnchorBarButton><m:Button icon="sap-icon://validate"\n\t\t\t\t\t          text="Check bookings"/></customAnchorBarButton><ObjectPageSubSection><m:VBox><smartFilterBar:SmartFilterBar id="idCheckBookingFilter" persistencyKey="searchListReportVariant"\n                        entitySet="ZC_HR237_Booking" enableBasicSearch="true" showClearOnFB="true" liveMode="true" showMessages="true"\n                                                     useToolbar="false"><smartFilterBar:layoutData><m:FlexItemData shrinkFactor="1"/></smartFilterBar:layoutData><smartFilterBar:controlConfiguration><smartFilterBar:ControlConfiguration key="pernr" mandatory="notMandatory"/><smartFilterBar:ControlConfiguration key="layer_id" mandatory="notMandatory"/></smartFilterBar:controlConfiguration></smartFilterBar:SmartFilterBar><smartTable:SmartTable id="idCheckBookingTable"\n\t\t\t\t\t                       smartFilterId="idCheckBookingFilter"\n\t\t\t\t\t                       entitySet="ZC_HR237_Booking"\n\t\t\t\t\t                       initiallyVisibleFields="datum,pernr,place_text,layer_id"\n\t\t\t\t\t                       header="Bookings"\n\t\t\t\t\t                       showRowCount="true"\n\t\t\t\t\t                       useExportToExcel="false"\n\t\t\t\t\t                       tableType="ResponsiveTable"\n\t\t\t\t\t                       enableAutoBinding="true"\n\t\t\t\t\t                       useTablePersonalisation="false"><smartTable:customToolbar><m:OverflowToolbar id="idCheckBookingToolbar" design="Transparent"></m:OverflowToolbar></smartTable:customToolbar></smartTable:SmartTable></m:VBox></ObjectPageSubSection></ObjectPageSection><ObjectPageSection titleUppercase="false" visible="{is_admin}"><customAnchorBarButton><m:Button icon="sap-icon://customize"\n\t\t\t\t\t          text="Settings"/></customAnchorBarButton><ObjectPageSubSection title=""><m:VBox><smartTable:SmartTable header="Schemes count"\n\t\t\t\t\t\t\t\t\t\t\t\tentitySet="ZC_HR237_Layer"\n\t\t\t\t\t\t\t\t\t\t\t\trequestAtLeastFields="layer_id,layer_text"\n\t\t\t\t\t\t\t\t\t\t\t\tinitiallyVisibleFields="layer_address,persa"\n\t\t\t\t\t\t\t\t\t\t\t\tshowRowCount="true"\n\t\t\t\t\t\t\t\t\t\t\t\tuseExportToExcel="true"\n\t\t\t\t\t\t\t\t\t\t\t\ttableType="ResponsiveTable"\n\t\t\t\t\t\t\t\t\t\t\t\tenableAutoBinding="true"><smartTable:customToolbar><m:OverflowToolbar design="Transparent"><m:ToolbarSpacer/><m:Button text="Create" press=".handleFormClick($event, \'Layer\', \'NEW\')"/></m:OverflowToolbar></smartTable:customToolbar><m:Table sticky="ColumnHeaders,HeaderToolbar"><m:columns><m:Column visible="true"><m:customData><core:CustomData key="p13nData" value=\'\\{"columnKey": "edit0", "columnIndex": 0}\'/></m:customData><m:Text text="Upload image"/></m:Column><m:Column visible="true"><m:customData><core:CustomData key="p13nData" value=\'\\{"columnKey": "edit1", "columnIndex": 1}\'/></m:customData><m:Text text="Desk positions"/></m:Column><m:Column visible="true"><m:customData><core:CustomData key="p13nData" value=\'\\{"columnKey": "edit2", "columnIndex": 2}\'/></m:customData><m:Text text="Schema"/></m:Column></m:columns><m:items><m:ColumnListItem><m:Link text="Change image" target="{layer_id}" press="uploadImage"></m:Link><m:Link text="Edit desks positions" target="{layer_id}^{layer_text}" press="onEditDeskPosition"></m:Link><m:Link text="{layer_text} ({layer_id})" target="{layer_id}^{layer_text}^{layer_address}^{persa}" press=".handleFormClick($event, \'Layer\', \'EDT\')"></m:Link></m:ColumnListItem></m:items></m:Table></smartTable:SmartTable></m:VBox></ObjectPageSubSection></ObjectPageSection></sections></ObjectPageLayout></mvc:View>'
}});
